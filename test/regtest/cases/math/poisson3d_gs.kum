алг
нач
  цел Nx, Ny, Nz
  Nx := 8
  Ny := 8
  Nz := 8

  вещ pi
  pi := 3.141592653589793
  вещ h
  h := 1.0 / (Nx - 1)
  вещ h2
  h2 := h * h

  вещ таб u[0:Nx-1, 0:Ny-1, 0:Nz-1]
  вещ таб f[0:Nx-1, 0:Ny-1, 0:Nz-1]

  цел i, j, k
  вещ x, y, z
  вещ err, uex, diff

  | Инициализация: точное решение u* = sin(pi x) sin(pi y) sin(pi z)
  | Правая часть f = 3*pi^2 * u*
  нц для i от 0 до Nx-1 шаг 1
    x := i * h
    нц для j от 0 до Ny-1 шаг 1
      y := j * h
      нц для k от 0 до Nz-1 шаг 1
        z := k * h
        u[i,j,k] := 0.0
        f[i,j,k] := 3.0 * pi * pi * sin(pi * x) * sin(pi * y) * sin(pi * z)
      кц
    кц
  кц

  | Граничные условия Дирихле: u = 0 на границе уже инициализировано нулями

  цел it, iters
  iters := 1000
  вещ tol
  tol := 1e-3

  | Gauss-Seidel (in-place) для -Δu = f: u = (соседи + h^2 f)/6
  нц для it от 0 до iters-1 шаг 1
    нц для i от 1 до Nx-2 шаг 1
      нц для j от 1 до Ny-2 шаг 1
        нц для k от 1 до Nz-2 шаг 1
          u[i,j,k] := (u[i+1,j,k] + u[i-1,j,k] + u[i,j+1,k] + u[i,j-1,k] + u[i,j,k+1] + u[i,j,k-1] + h2 * f[i,j,k]) / 6.0
        кц
      кц
    кц

    | Оценка ошибки и возможный ранний выход
    err := 0.0
    нц для i от 0 до Nx-1 шаг 1
      x := i * h
      нц для j от 0 до Ny-1 шаг 1
        y := j * h
        нц для k от 0 до Nz-1 шаг 1
          z := k * h
          uex := sin(pi * x) * sin(pi * y) * sin(pi * z)
          diff := abs(u[i,j,k] - uex)
          err := max(err, diff)
        кц
      кц
    кц
    если err < tol то
      выход
    все
  кц

  | Финальная проверка
  err := 0.0
  нц для i от 0 до Nx-1 шаг 1
    x := i * h
    нц для j от 0 до Ny-1 шаг 1
      y := j * h
      нц для k от 0 до Nz-1 шаг 1
        z := k * h
        uex := sin(pi * x) * sin(pi * y) * sin(pi * z)
        diff := abs(u[i,j,k] - uex)
        err := max(err, diff)
      кц
    кц
  кц

  вывод "Poisson3D-GS: N=", Nx, " max|u-uex|=", err, "\n"
  если err < tol то
    вывод "OK\n"
  иначе
    вывод "FAIL\n"
  все
кон
