алг main
нач
  | Матвект: y = A * x, где A — нижнетреугольная матрица из единиц,
  | x — вектор из единиц. Ожидается y[i] = i+1.

  цел n,i,j
  n := 256
  вещ таб A[0:n-1,0:n-1]
  вещ таб x[0:n-1]
  вещ таб y[0:n-1]
  вещ sum, absv
  вещ res_l2_sq, res_l2, res_inf, err

  | Инициализация A и x
  нц для i от 0 до n-1
    нц для j от 0 до n-1
      если j <= i то
        A[i,j] := 1.0
      иначе
        A[i,j] := 0.0
      все
    кц
    x[i] := 1.0
  кц

  | Вычисление y = A * x
  нц для i от 0 до n-1
    sum := 0.0
    нц для j от 0 до n-1
      sum := sum + A[i,j] * x[j]
    кц
    y[i] := sum
  кц

  | Проверка: ожидаем y[i] = i+1
  res_l2_sq := 0.0
  res_inf := 0.0
  нц для i от 0 до n-1
    err := y[i] - (i + 1.0)
    absv := err; если absv < 0.0 то absv := -absv все
    res_l2_sq := res_l2_sq + err * err
    если absv > res_inf то res_inf := absv все
  кц
  res_l2 := sqrt(res_l2_sq)

  вывод "matvec: ||e||_2^2 = ", res_l2_sq, нс
  вывод "matvec: ||e||_2    = ", res_l2, нс
  вывод "matvec: ||e||_inf  = ", res_inf, нс
кон
